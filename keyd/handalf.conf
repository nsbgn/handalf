[ids]

# Internal keyboard
0001:0001
# Microsoft Keyboard
045e:07a5
# Logitech USB receiver mouse
046d:c548

[global]
chord_timeout = 50
overload_tap_timeout = 300
oneshot_timeout = 500
disable_modifier_guard = 0

[main]
# capslock = timeout(overload(Fn, backspace), 300, backspace)
capslock = backspace
leftmeta = layer(alt)
leftalt = timeout(overload(Fn, esc), 140, layer(Fn))
rightalt = oneshot(altgr)
tab = tab

leftshift = oneshot(shift)
rightshift = backslash
[ = enter
] = [
\ = ]

[shift:S]
capslock = backspace

# We use rightmeta as the Compose key, because I want the Context-Menu key to
# be available. RightMeta does not seem to be present on most keyboards anyway,
# and it is possible to select it as Compose key on Gnome.
leftshift = rightmeta
# layerm(shift, rightmeta)
# The oneshot shift wants to carry over on double tapping leftshift, but we
# don't want that in this case: we want to keep shift enabled when we tap-hold,
# but not have it still on oneshot when we tap-tap.

[altgr:G]
capslock = backspace
rightalt = numlock

# Uncomment this if you want to enable symbols at the keycode level
# include bindings_symbols

# WORKAROUND: Double tapping space while holding shift/altgr (thus entering
# doublespace) should not keep altgr/shift active unless altgr/shift is
# actually still pressed. This is why we add shift2/altgr2 layers whose only
# purpose is to avoid triggering the continued activation of modifiers during
# oneshots. This is not perfect but it avoids the most egregious issues
# [shift2:S]
# space = oneshotm(doublespace, space)

# [shift:S]
# ALTGR = overload(altgr, swap(altgr))

# [altgr:G]
# ALTGR = overload(shift, swap(shift))

# [altgr2:G]
# space = oneshotm(doublespace, space)

#[doublespace]
#[doublespace+shift2]
#space = macro(backspace _)
#[doublespace+altgr2]
#space = macro(backspace kpdot)

[Fn]
# capslock = backspace
# leftshift = overload(shift, capslock)
# rightalt = overload(altgr, numlock)
# leftshift = overload(shift, oneshot(shift_tap))
# leftcontrol = rightcontrol
# leftmeta = cancel
space = timeout(layer(Meta), 140, oneshot(Meta))
include bindings_fn

[Meta:M]
include bindings_meta

[altgr+shift]
include bindings_symbols

[NavMeta+shift_tap]
leftshift = overload(shift, capslock)

include tweak_mods_on_nav
